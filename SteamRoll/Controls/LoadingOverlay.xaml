<UserControl x:Class="SteamRoll.Controls.LoadingOverlay"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             Visibility="Collapsed">
    
    <UserControl.Resources>
        <!-- Spinner rotation animation -->
        <Storyboard x:Key="SpinAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="SpinnerTransform"
                             Storyboard.TargetProperty="Angle"
                             From="0" To="360" Duration="0:0:1.2">
                <DoubleAnimation.EasingFunction>
                    <SineEase EasingMode="EaseInOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Pulse animation for glow effect -->
        <Storyboard x:Key="PulseAnimation" RepeatBehavior="Forever" AutoReverse="True">
            <DoubleAnimation Storyboard.TargetName="GlowEffect"
                             Storyboard.TargetProperty="Opacity"
                             From="0.3" To="0.7" Duration="0:0:1.5"/>
        </Storyboard>
        
        <!-- Fade in animation -->
        <Storyboard x:Key="FadeIn">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                             From="0" To="1" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <QuadraticEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        
        <!-- Fade out animation -->
        <Storyboard x:Key="FadeOut">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                             From="1" To="0" Duration="0:0:0.2"/>
        </Storyboard>
    </UserControl.Resources>
    
    <!-- Full overlay with blur effect simulation -->
    <Border Background="#EE0D1117">
        <Grid>
            <!-- Subtle gradient background -->
            <Rectangle>
                <Rectangle.Fill>
                    <RadialGradientBrush Center="0.5,0.5" RadiusX="0.6" RadiusY="0.6">
                        <GradientStop Color="#20A371F7" Offset="0"/>
                        <GradientStop Color="#00000000" Offset="1"/>
                    </RadialGradientBrush>
                </Rectangle.Fill>
            </Rectangle>
            
            <!-- Centered card container - Fixed size to prevent jarring resize -->
            <Border HorizontalAlignment="Center" VerticalAlignment="Center"
                    Background="#2A161B22" CornerRadius="20" Padding="48,40"
                    BorderBrush="#40A371F7" BorderThickness="1"
                    Width="420">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="40" ShadowDepth="0" Opacity="0.4" Color="#A371F7"/>
                </Border.Effect>
                
                <StackPanel HorizontalAlignment="Center">
                    <!-- Spinner Container with glow -->
                    <Grid Width="120" Height="120" Margin="0,0,0,32">
                        <!-- Background glow -->
                        <Ellipse x:Name="GlowEffect" Width="100" Height="100" Opacity="0.4">
                            <Ellipse.Fill>
                                <RadialGradientBrush Center="0.5,0.5">
                                    <GradientStop Color="#58A6FF" Offset="0"/>
                                    <GradientStop Color="#00000000" Offset="1"/>
                                </RadialGradientBrush>
                            </Ellipse.Fill>
                        </Ellipse>
                        
                        <!-- Outer track ring -->
                        <Ellipse Width="90" Height="90" StrokeThickness="4" Stroke="#20FFFFFF"
                                 HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        
                        <!-- Spinning gradient ring -->
                        <Ellipse Width="90" Height="90" StrokeThickness="4"
                                 HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Ellipse.Stroke>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#58A6FF" Offset="0"/>
                                    <GradientStop Color="#A371F7" Offset="0.4"/>
                                    <GradientStop Color="#F778BA" Offset="0.7"/>
                                    <GradientStop Color="Transparent" Offset="1"/>
                                </LinearGradientBrush>
                            </Ellipse.Stroke>
                            <Ellipse.RenderTransform>
                                <RotateTransform x:Name="SpinnerTransform" CenterX="45" CenterY="45"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>
                        
                        <!-- Inner solid ring -->
                        <Ellipse Width="70" Height="70" StrokeThickness="2" Stroke="#30FFFFFF"
                                 HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        
                        <!-- Center icon with background -->
                        <Border Width="54" Height="54" CornerRadius="27" 
                                HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#2558A6FF" Offset="0"/>
                                    <GradientStop Color="#25A371F7" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <TextBlock Text="ðŸ“¦" FontSize="28" FontFamily="Segoe UI Emoji"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                    
                    <!-- Status message - Fixed height, text trimming to prevent resize -->
                    <TextBlock x:Name="StatusText" Text="Processing..." FontSize="18" FontWeight="SemiBold"
                               Foreground="#F0F6FC" TextAlignment="Center" 
                               TextTrimming="CharacterEllipsis" TextWrapping="NoWrap"
                               Width="320" Height="26"
                               HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    
                    <!-- Progress percentage -->
                    <TextBlock x:Name="ProgressText" Text="" FontSize="14"
                               Foreground="#8B949E" TextAlignment="Center"
                               HorizontalAlignment="Center" Margin="0,0,0,20"/>
                    
                    <!-- Progress bar container -->
                    <Border Background="#21262D" CornerRadius="6" Width="320" Height="12">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="4" ShadowDepth="1" Direction="270" Opacity="0.3" Color="Black"/>
                        </Border.Effect>
                        <Grid>
                            <!-- Progress bar fill -->
                            <Border x:Name="ProgressBar" CornerRadius="6" HorizontalAlignment="Left" Width="0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#58A6FF" Offset="0"/>
                                        <GradientStop Color="#A371F7" Offset="0.5"/>
                                        <GradientStop Color="#F778BA" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                            
                            <!-- Shine effect overlay -->
                            <Border CornerRadius="6" Opacity="0.2" HorizontalAlignment="Stretch" Height="6" VerticalAlignment="Top" Margin="0,0,0,0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="White" Offset="0"/>
                                        <GradientStop Color="Transparent" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</UserControl>

